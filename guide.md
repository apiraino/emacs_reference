## First emacs setup

* Install latest Emacs 25 (don't start it yet)
* Install Prelude: https://github.com/bbatsov/prelude
* Copy `~/.emacs.d/sample/prelude-modules.el` in `~/.emacs.d/prelude-modules.el`
* Uncomment prelude modules: python, rust, yaml. Comment and disable: erc, ivy
* Copy my emacs config files in the `personal` dir
* Start Emacs now (only desired packages will be installed)

### What's in my personal lisp file
* `ag`: super fast grep replacement
* `jedi`: Python autocompletion
* `flycheck`: Python syntax-checking
* `elpy`: Emacs Lisp Python Environment
* `flycheck-rust`: Rust syntax-checking
* `racer`: Rust code-completion, goto-definitionand docs browsing
* `yaml-mode`: Major mode fpor YAML files
* `py-autopep8`: Python PEP8 linter
* `git-gutter`: git diff on the fly
* `org-journal`: great tool to write a developer's diary
* `xclip` (linux only) yanked text in emacs is available in X11 (overwrites X11 clipboard)
* `rcirc` (embedded IRC client) configuration
* `ox-wk` module to export from ORG mode to Dokuwiki

#### Run FlyCheck

`C-c ! l, n, ...`

### Common commands to move around

<http://physics.clarku.edu/sip/tutorials/intro_emacs.html>

### Push/Pop to jump around in Python code (provided by Prelude) ##

`C-c .` and `C-c ,` jump to definition, jump back

### Indent/Unindent a selected region

`C-u 4` + `C-x TAB` +indent
`C-u -4`, `C-x TAB` -indent
`C-x TAB` then arrow left/right

### Global search and replace

`M-% string <RET> newstring <RET>` (doesn't work anymore)

`ESC % string <RET> newstring <RET>`

### Reload a buffer

`M-x revert-buffer`

### Read a file into current buffer

`C-x insert-file`

### Windows

https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window.html

`C-x o`   Select another window (other-window). That is `o`, not zero.

`C-x 1`   Close all windows but the current one

`C-M-v`   Scroll the next window (scroll-other-window).

### Save the current buffer as new file (write-file) a.k.a. `save as`

`C-x C-w`

### Rename current file in buffer

`C-x C-j` (dired-jump to current file)

R to rename the file (or dired-do-rename).

`C-x k RET` to go back to the (renamed) buffer

### Grep

`C-c p g`       Old grep shortcut

`C-c p s g`     New grep shortcut

### Show Python docstring for function (provided by Prelude)

`C-c ?`

### Abbreviations

* write `import pdb; pdb.set_trace()"`
* `C-u 5`: ???
* `C-a ixg`: ???
* input name of the abbreviation shortcut (e.g. `trace`)
* `M-x write-abbrev-file`: save abbreviation in file (e.g. `~user/.emacs.d/abbrev_defs`)
* `M-x abbrev-mode`: enable abbreviation mode
* use abbreviation: write `trace<space>` and ... voilà
* Now you can extend the abbreviation file directly and reload with:
`M-x load-file ~user/.emacs.d/abbrev_defs`

### Retrieve from cut&paste stack

`C-y`: pop
`M-y`: show stack
`C-y` + `M-y` to walk through the stack entries

### Bookmarks

* `C-x rm` Save a bookmark
* `C-x rb` Move to a bookmark
* `M-x bookmark-delete <RET> bookmark <RET>` Delete a bookmark

### Apropos

`C-h a`

### Select entire buffer (select all)

`C-x h`

### Reindent buffer and remove TABs (e.g. in HTML files generated by evil Adobe IDEs)
* Select region of entire buffer
* `tab` to remove excessive indent
* `M-x untabify` to replace evil TABs with virtuous spaces

### Go to line number

`M-g g <num>`

### Go to the top of the file

`ESC <`

`C-Home`

### Go to the bottom of the file

`ESC >`

`C-End`

### Themes

`M-x customize-themes`: enter theme selection

`M-x color-theme-...`: select a theme

`M-x disable-theme`: yeah, disable a theme

### Search and replace in entire project (whatever 'project' means...)

`C-c p r`

### Join lines

`C-^`

### Registers

`C-x r s [a, 1, b, 5, r, ...]`: copy region into register [a, 1, b, 5, r, ...] (copy-to-register)

`C-x r i [a, 1, b, 5, r, ...]`: insert text from register [a, 1, b, 5, r, ...] (insert-register)

### Comment/Uncomment a region

`M-;`

### Update all installed EMACS packages

`M-x package-list-packages`

`Ux` <confirm>

### Kill some buffers

M-x kill-some-buffers

### Find command defined by a key binding
`C-h k` then execute the keycombo

### Magit survival guide

* `M-x magit-status` Get into Magit
* `d` diff changes
* `s`, `u` and `d`: stage, unstage, discard hunk
* `c` then `c`: commit changes
* Write commit message then `C-x s` and `C-c C-c`
* `P u` to push to origin

### Hot reload EMACS config (f.e. to refresh pkg installed)

Open your custom `.el` config file in a new buffer

`M-x eval-buffer` 

### Recursively find and replace in files not already open

https://stackoverflow.com/a/271136

## Rust specific setup

* install racer

  `$ cargo install racer`

  `$ rustup component add rust-src`

  `$ export RUST_SRC_PATH="$(rustc --print sysroot)/lib/rustlib/src/rust/src"`

* Install autoformatter

  `$ cargo install rustfmt`

* Cargo specific commands available

  `C-c C-c C-b` to run cargo build
  
  `C-c C-c C-r` to run cargo run
  
  `C-c C-c C-t` to run cargo test

## Org mode primer

`C-c C-e` export an org buffer to something else (HTML, markdown, etc.)

`C-c C-o` open a link in default browser

`C-c C-l` edit a link

`M-x customize-variable RET org-export-backends` modify export modes enabled

In order to export to Mediawiki (which I need), there's no plugin on Melpa, therefore download a lisp file `ox-wk.el` from [https://github.com/w-vi/ox-wk.el]

Install these adding these to your emacs personal init file:
```
(load-file "~/.emacs.d/path/to/ox-wk.el")
(require 'ox-wk)
```

Use it with:

`org-wk-export-as-wiki` export to temporary buffer

`org-wk-export-to-wiki` expot to "txt" file

### org-journal

* `M-x calendar` open calendar
* `M-x org-journal` set journal mode
* `C-c C-s` (<= `org-journal-search`) search term in journal (accepting the `org-read-date` format such as "-1y" or "-1m")
* `C-f f f` search term in all entries (`org-journal-search-forever`)
  buffers are opened read-only. `C-c view-mode` or `e` to edit.

#### calendar-more
* `C-j` view highlighted journal entry
* `e` switch from read-only to edit mode for current journal entry
* `C-u i j` edit selected journal entry (`org-journal-new-date-entry`)
* `C-c C-j` edit today's journal (creating a new entry)
* `C-u C-c C-j`: edit today's journal (**without** creating a new entry)

For more, see [here](https://github.com/bastibe/org-journal/blob/9fc8eaf9279563f79d9ba7ff1d381534cfa57ec3/org-journal.el#L45)

Formatting text:

* `*bold*, /italic/, _underlined_, =verbatim=, ~code~ and ‘+strike-through+’`

References:

- Org Mode manual: https://orgmode.org/manual/index.html
- Org Mode markup for export: https://orgmode.org/manual/Markup.html#Markup
- Org Journal: https://www.emacswiki.org/emacs/OrgJournal
- https://github.com/bastibe/org-journal/issues/93#issuecomment-360707226

## Embedded IRC client

`M-x irc` enable IRC mode
`C-u M-x rcirc` setup connection parameters (server, port, nick, channel, etc.)
